create or replace PROCEDURE HRIS_LATE_LEAVE_DEDUCTION(
    P_MONTH_ID HRIS_MONTH_CODE.MONTH_ID%TYPE)
AS
  V_MONTH_START_DATE HRIS_MONTH_CODE.FROM_DATE%TYPE;
  V_MONTH_END_DATE HRIS_MONTH_CODE.TO_DATE %TYPE;
BEGIN
  SELECT FROM_DATE,
    TO_DATE
  INTO V_MONTH_START_DATE,
    V_MONTH_END_DATE
  FROM HRIS_MONTH_CODE
  WHERE MONTH_ID= P_MONTH_ID;
  --
  DELETE
  FROM HRIS_EMPLOYEE_PENALTY_DAYS
  WHERE ATTENDANCE_DT BETWEEN V_MONTH_START_DATE AND V_MONTH_END_DATE;
  --
  FOR attendance IN
  (SELECT         *
  FROM HRIS_ATTENDANCE_DETAIL
  WHERE ATTENDANCE_DT BETWEEN V_MONTH_START_DATE AND V_MONTH_END_DATE
  )
  LOOP
    IF attendance.OVERALL_STATUS IN ('BA','LA') THEN
      INSERT
      INTO HRIS_EMPLOYEE_PENALTY_DAYS
        (
          EMPLOYEE_ID,
          ATTENDANCE_DT
        )
        VALUES
        (
          attendance.EMPLOYEE_ID,
          attendance.ATTENDANCE_DT
        );
    END IF;
  END LOOP;
END;