CREATE OR REPLACE PROCEDURE HRIS_DAILY_SYSTEM_CHECK(
    P_DATE DATE:=NULL)
AS
  V_DATE            DATE;
  IS_START_OF_MONTH CHAR(1 BYTE);
BEGIN
  --SET DATE
  IF P_DATE IS NULL THEN
    V_DATE  :=TRUNC(SYSDATE);
  ELSE
    V_DATE :=TRUNC(P_DATE);
  END IF;
  --
  BEGIN
    SELECT 'Y'
    INTO IS_START_OF_MONTH
    FROM HRIS_MONTH_CODE
    WHERE TRUNC(FROM_DATE) = V_DATE;
  EXCEPTION
  WHEN NO_DATA_FOUND THEN
    IS_START_OF_MONTH:='N';
  END;
  --SERVICE STATUS UPDATE
  FOR service IN
  (SELECT * FROM HRIS_JOB_HISTORY WHERE EVENT_DATE =V_DATE
  )
  LOOP
    HRIS_UPDATE_EMPLOYEE_SERVICE(service.JOB_HISTORY_ID);
  END LOOP;
  --END OF SERVICE STATUS UPDATE
  --  RESET MONTHLY LEAVES
  IF IS_START_OF_MONTH='Y' THEN
    HRIS_RECALC_MONTHLY_LEAVES;
  END IF;
  --  END OF RESET MONTHLY LEAVES
END;