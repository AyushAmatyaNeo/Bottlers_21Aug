CREATE OR REPLACE TRIGGER HRIS_BEFORE_LEAVE_REQUEST BEFORE
  UPDATE ON HRIS_EMPLOYEE_LEAVE_REQUEST FOR EACH ROW DECLARE V_BALANCE NUMBER(3,1);
  BEGIN
    IF(:new.HALF_DAY            IN ('F','S')) THEN
      V_BALANCE:= :new.NO_OF_DAYS/2;
    ELSE
      V_BALANCE:= :new.NO_OF_DAYS;
    END IF;
    IF :old.STATUS IN ('RQ','RC') AND :new.STATUS ='AP' THEN
      UPDATE HRIS_EMPLOYEE_LEAVE_ASSIGN
      SET BALANCE       = BALANCE -V_BALANCE
      WHERE EMPLOYEE_ID = :new.EMPLOYEE_ID
      AND LEAVE_ID      =:new.LEAVE_ID;
    ELSIF :old.STATUS   ='AP' AND :new.STATUS = 'C' THEN
      UPDATE HRIS_EMPLOYEE_LEAVE_ASSIGN
      SET BALANCE       = BALANCE +V_BALANCE
      WHERE EMPLOYEE_ID = :new.EMPLOYEE_ID
      AND LEAVE_ID      =:new.LEAVE_ID;
    END IF;
  END;