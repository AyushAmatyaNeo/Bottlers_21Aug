<?php
/**
 * Load Javascript files here
 */
$this->headScript()->appendFile($this->basePath('js/angular.min.js'));
$this->headScript()->appendFile($this->basePath('js/ng-bootstrap-multiselect.js'));
$this->headScript()->appendFile($this->basePath('js/Payroll/MonthlyValue/detailController.js'));
$this->headScript()->appendFile($this->basePath('assets/global/plugins/bootstrap-multiselect/js/bootstrap-multiselect.js'));
?>

<script>
    document.menu =<?php
$menu = ["id" => "menuPayroll", "subMenu" => ["id" => "subMenuMonthlyValue"], "subMenuChild" => ["id" => "subMenuChildMonthlyValDetail"]];
echo json_encode($menu);
?>;
    document.url = '<?= $this->url("restful", ["action" => "index"]) ?>';
    document.branches =<?= json_encode($branches) ?>;
    document.departments =<?= json_encode($departments) ?>;
    document.designations =<?= json_encode($designations) ?>;
    document.monthlyValues =<?= json_encode($monthlyValues) ?>;
</script>
<div class="page-bar">
    <?= $this->navigation('Zend\Navigation\monthlyValue')->breadcrumbs()->setMinDepth(0)->setPartial('partial/breadcrumb') ?>
</div>

<div ng-app="hris" ng-controller="monthlyValueDetailController">
    <div class="row">
        <div class="col-sm-12">
            <div class="portlet solid grey">
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-sm-2">
                            <label>
                                Branch
                            </label>
                            <select class="form-control" ng-model="branch" ng-options="key as branch for (key,branch) in branches">
                                <option value="">All</option>
                            </select>
                        </div>
                        <div class="col-sm-2">
                            <label>
                                Department
                            </label>
                            <select class="form-control" ng-model="department"
                                    ng-options="key as department for (key,department) in departments">
                                <option value="">All</option>
                            </select>
                        </div>
                        <div class="col-sm-2">
                            <label>
                                Designation
                            </label>
                            <select class="form-control" ng-model="designation"
                                    ng-options="key as designation for (key,designation) in designations">
                                <option value="">All</option>
                            </select>
                        </div>
                        <div class="col-sm-4 " >
                            <label>
                                Flat Values
                            </label>
                            <div>
                                <multiselect
                                    ng-change="selectedMonthlyValuesChange()()"
                                    ng-model="selectedMonthlyValues"
                                    options="monthlyValue.text for monthlyValue in monthlyValues"    
                                    data-multiple="true"                 
                                    data-compare-by="id"                 
                                    scroll-after-rows="5"                
                                    filter-after-rows="5"      
                                    max-width="100"                      
                                    tabindex="-1">                     
                                </multiselect>
                                <button ng-click="selectAllFlagFN()" class="" ng-bind="selectAllFlag ? 'Deselect All' : 'Select All'">
                                </button>
                            </div>
                        </div>

                        <div class="col-sm-2">
                            <button ng-click="view()" class="btn btn-sm yellow pull-right">
                                View
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="margin-top-20 scroller" style="height: 400px;">
        <table class="table" >
            <thead>
                <tr>
                    <th>
                        Employee Id
                    </th>
                    <th>
                        Employee Name
                    </th>
                    <th ng-repeat="keys in monthlyValuekeys" ng-bind="monthlyValuesI[keys]">

                    </th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="row in tableDataCopy">
                    <td ng-bind="row.EMPLOYEE_ID">

                    </td>
                    <td>
                        <span ng-bind="row.FIRST_NAME"></span>
                        <span ng-bind="row.MIDDLE_NAME"></span>
                        <span ng-bind="row.LAST_NAME"></span>
                    </td>
                    <td ng-repeat="keys in monthlyValuekeys">
                        <input class="form-control" type="number" ng-model="row[keys]">
                    </td>
                </tr>


            </tbody>
            <tfoot>
                <tr>
                    <td>

                    </td>
                    <td>

                    </td>
                    <td ng-repeat="keys in monthlyValuekeys">
                        <input class="form-control" type="number" ng-model="colVal"
                               ng-change="changeAllColVal(keys, colVal)">
                    </td>
                </tr>
            </tfoot>
        </table>

    </div>
    <div class="row">
        <div class="col-sm-12">
            <button class="btn btn-success pull-right" ng-click="setMonthlyValue()">Assign Monthly Value</button>
        </div>
    </div>
</div>