<div class="tab-pane <?= ($tab==3)?"active":""; ?>" id="portlet_tab2_3">
    <form method="post" action="<?= $this->url("appraisalReport",['action'=>'view','appraisalId'=>$appraisalId,'employeeId'=>$employeeId,'tab'=>3]) ?>" name="performanceAppraisalForm" id="appraisalReview2">
    <div class="row">
        <?php
        $disabled = ($questionForCurStage==0)?'disabled':'';
        $questionOnPreTab=0;
        foreach ($reviewerQuestionTemplate as $reviewerQuestionList) { ?>
            <div class="col-md-12 margin-bottom-10">
                <div style="border: 1px solid #ddd; padding: 0px 10px 10px 10px;">
                    <h6 style="border-bottom: 1px solid #ddd; padding-bottom: 1%; color: black; font-weight: 400;"><?php echo $reviewerQuestionList['HEADING_EDESC']; ?></h6>
                    <div class="row">
                        <?php foreach ($reviewerQuestionList['QUESTIONS'] as $reviewerQuestionRow) { ?>
                            <div  class="col-md-12 margin-bottom-10"> 
                                <div class="row">
                                    <div class="col-sm-8">
                                        <label> <h7 style="font-size:12px;"><?php echo $reviewerQuestionRow['QUESTION_EDESC']; ?></h7>  </label> 
                                        <?php 
                                        $keyForRQuestion = ($reviewerQuestionRow['ANSWER']==null || count($reviewerQuestionRow['ANSWER'])==0)?$reviewerQuestionRow['QUESTION_ID']:array_keys($reviewerQuestionRow['ANSWER'])[0];
                                        if($reviewerQuestionRow['REVIEWER_FLAG']=='Y'){ ?>
                                        <input type="hidden" value="<?= (count($reviewerQuestionRow['ANSWER'])>0)?array_keys($reviewerQuestionRow['ANSWER'])[0]:0; ?>" name="answerId[]"/>
                                            <?php if($reviewerQuestionRow['ANSWER_TYPE']=="RADIO"){ ?>
                                            <div class="md-radio-inline">
                                                <?php $customRenderer($performanceAppraisalObj("answer[".$keyForRQuestion."]", $reviewerQuestionRow['ANSWER_TYPE'],(count($reviewerQuestionRow['QUESTION_OPTIONS'])>0)?$reviewerQuestionRow['QUESTION_OPTIONS']:null,($reviewerQuestionRow['ANSWER']!=null && count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['ANSWER']:null,'disabled')); ?>
                                            </div>
                                            <?php } else if($reviewerQuestionRow['ANSWER_TYPE']=="CHECKBOX"){?>
                                                <div class="md-checkbox-inline">
                                                    <?php $customRendererForCheckbox($performanceAppraisalObj("answer[".$keyForRQuestion."][]", $reviewerQuestionRow['ANSWER_TYPE'],(count($reviewerQuestionRow['QUESTION_OPTIONS'])>0)?$reviewerQuestionRow['QUESTION_OPTIONS']:null,($reviewerQuestionRow['ANSWER']!=null && count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['ANSWER']:null,'disabled')); ?>
                                                </div>
                                            <?php } else{
                                                print_r($this->formElement($performanceAppraisalObj("answer[".$keyForRQuestion."]", $reviewerQuestionRow['ANSWER_TYPE'],(count($reviewerQuestionRow['QUESTION_OPTIONS'])>0)?$reviewerQuestionRow['QUESTION_OPTIONS']:null,($reviewerQuestionRow['ANSWER']!=null && count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['ANSWER']:null,'disabled')));
                                            }
                                        }
                                        ?>
                                    </div>
                                    <?php if($reviewerQuestionRow['REVIEWER_RATING']=='Y'){ 
                                        if($reviewerQuestionRow['REVIEWER_FLAG']=='N'){?>
                                        <input type="hidden" value="<?= (count($reviewerQuestionRow['ANSWER'])>0)?array_keys($reviewerQuestionRow['ANSWER'])[0]:0; ?>" name="answerId[]"/>
                                        <input type="hidden" value="" name="<?= "answer[".$keyForRQuestion."]"; ?>"/>
                                     <?php }?>
                                    <div class="col-sm-1">
                                        <input type="hidden" value="<?= (count($reviewerQuestionRow['ANSWER'])>0)?array_keys($reviewerQuestionRow['ANSWER'])[0]:0; ?>" name="answerId[]"/>
                                        <label>Self Rating:</label><input class="form-control" type="number" name="<?= "answer[".$keyForRQuestion.".rr]"?>" value="<?= ($reviewerQuestionRow['ANSWER']!=null||count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['RATING']:null ?>" <?= 'disabled' ?> min="<?= $reviewerQuestionRow['MIN_VALUE'] ?>" max="<?= $reviewerQuestionRow['MAX_VALUE'] ?>" required="required"/>
                                    </div>
                                    <?php }
                                    if(count($reviewerQuestionRow['ANSWER'])>0 && array_values($reviewerQuestionRow['ANSWER'])[0]['HR_ANSWER_ID']!=null){
                                        $keyForHrQuestion = (array_values($reviewerQuestionRow['ANSWER'])[0]['HR_ANSWER_ID']==null)?$reviewerQuestionRow['QUESTION_ID']:array_values($reviewerQuestionRow['ANSWER'])[0]['HR_ANSWER_ID'];
                                        if($reviewerQuestionRow['HR_FLAG']=='Y'){ 
                                            $questionOnPreTab+=1;
                                            ?>
                                            <div class="col-sm-3">
                                                <label>HR's Comment:</label>
                                                <?php if($reviewerQuestionRow['ANSWER_TYPE']=="RADIO"){ ?>
                                                    <div class="md-radio-inline">
                                                        <?php $customRenderer($performanceAppraisalObj("answer[".$keyForHrQuestion."]", $reviewerQuestionRow['ANSWER_TYPE'],(count($reviewerQuestionRow['QUESTION_OPTIONS'])>0)?$reviewerQuestionRow['QUESTION_OPTIONS']:null,($reviewerQuestionRow['ANSWER']!=null||count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['HR_ANSWER']:null,$disabled)); ?>
                                                    </div>
                                                    <?php } else if($reviewerQuestionRow['ANSWER_TYPE']=="CHECKBOX"){?>
                                                        <div class="md-checkbox-inline">
                                                            <?php $customRendererForCheckbox($performanceAppraisalObj("answer[".$keyForHrQuestion."][]", $reviewerQuestionRow['ANSWER_TYPE'],(count($reviewerQuestionRow['QUESTION_OPTIONS'])>0)?$reviewerQuestionRow['QUESTION_OPTIONS']:null,($reviewerQuestionRow['ANSWER']!=null||count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['HR_ANSWER']:null,$disabled)); ?>
                                                        </div>
                                                    <?php } else{
                                                        print_r($this->formElement($performanceAppraisalObj("answer[".$keyForHrQuestion."]", $reviewerQuestionRow['ANSWER_TYPE'],(count($reviewerQuestionRow['QUESTION_OPTIONS'])>0)?$reviewerQuestionRow['QUESTION_OPTIONS']:null,($reviewerQuestionRow['ANSWER']!=null||count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['HR_ANSWER']:null,$disabled)));
                                                    }?>
                                            </div>
                                        <?php }?>
                                        <?php if($reviewerQuestionRow['HR_RATING']=='Y'){ 
                                            $questionOnPreTab+=1;
                                            if($reviewerQuestionRow['HR_FLAG']=='N'){?>
                                            <input type="hidden" value="<?= (count($reviewerQuestionRow['ANSWER'])>0)?array_keys($reviewerQuestionRow['ANSWER'])[0]:0; ?>" name="answerId[]"/>
                                            <input type="hidden" value="" name="<?= "answer[".$keyForHrQuestion."]"; ?>"/>
                                            <?php }?>
                                        <div class="col-sm-1">
                                            <label>HR Rating:</label><input class="form-control" type="number" name="<?= "answer[".$keyForHrQuestion.".hr]"?>" value="<?= ($reviewerQuestionRow['ANSWER']!=null||count($reviewerQuestionRow['ANSWER'])>0)?array_values($reviewerQuestionRow['ANSWER'])[0]['HR_RATING_VAL']:null ?>"  min="<?= $reviewerQuestionRow['MIN_VALUE'] ?>" max="<?= $reviewerQuestionRow['MAX_VALUE'] ?>" <?= $disabled ?>/>
                                        </div>
                                        <?php }
                                    }?>
                                </div>
                            </div>
                        <?php } ?>
                    </div>
                </div>
            </div>
        <?php } ?>
        <?php if(($assignedAppraisalDetail['KPI_SETTING']=='Y') && ($assignedAppraisalDetail['COMPETENCIES_SETTING']=='Y')){ ?>
        <div class="col-sm-12">
            <label style="font-size:12px !important;">
        I agree with the Appraiser's overall performance assessment. Agree? 
            </label>
            <div class="md-radio-inline">
                <div class="md-radio">
                    <input disabled="disabled" type="radio" id="radio14" name="reviewerAgree" value="Y" class="md-radiobtn" <?= ($assignedAppraisalDetail['REVIEWER_AGREE']=='Y' || $assignedAppraisalDetail['REVIEWER_AGREE']==null)?"checked":""; ?>>
                    <label for="radio14">
                        <span class="inc"></span>
                        <span class="check"></span>
                        <span class="box"></span> Yes </label>
                </div>
                <div class="md-radio">
                    <input disabled="disabled" type="radio" id="radio15" name="reviewerAgree" value="N" class="md-radiobtn"  <?= ($assignedAppraisalDetail['REVIEWER_AGREE']=='N')?"checked":""; ?>>
                    <label for="radio15">
                        <span class="inc"></span>
                        <span class="check"></span>
                        <span class="box"></span> No </label>
                </div>
            </div>
        </div>
        <?php } ?>
    </div>
    <?php if($questionForCurStage>0 && $questionOnPreTab>0){ ?>
    <div class="row margin-top-10">
        <div class="col-sm-12">
            <div class="form-group">
                <button type="submit" id="submit" class="btn btn-success pull-right">
                    NEXT
                </button>
            </div>
        </div>
    </div>
    <?php } ?>
    </form>
    <?php
    print $this->partial('appraisal/layout/reviewer-remarks.phtml');
    ?>
</div>
